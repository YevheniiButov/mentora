{# templates/test_setup.html (Версия до BI toets, с категориями) #}
{% extends "base.html" %}

{% block title %}
    {% if lang == 'ru' %}Начать тест по категориям{% elif lang == 'nl' %}Start Categorie Toets{% else %}Start Category Test{% endif %} - Become a Tandarts
{% endblock %}

{% block styles %}
{{ super() }}
<style>
    .test-setup-card { max-width: 600px; margin: 2rem auto; }
    .category-list { max-height: 200px; overflow-y: auto; border: 1px solid #dee2e6; padding: 1rem; border-radius: 0.375rem; margin-bottom: 1rem; }
    .category-list .form-check { margin-bottom: 0.5rem; }
</style>
{% endblock %}

{% block content %}
<div class="container main-content-padding pt-4 forum-page-content">
    <div class="card test-setup-card shadow-sm">
        <div class="card-header">
            <h1 class="h4 mb-0">{% if lang == 'ru' %}Настройка Теста по Категориям{% elif lang == 'nl' %}Instellingen Categorie Toets{% else %}Category Test Setup{% endif %}</h1>
        </div>
        <div class="card-body">
            {# Используем старый маршрут для запуска теста по КАТЕГОРИЯМ #}
            <form method="post" action="{{ url_for('tests_bp.start_custom_test', lang=lang) }}">
                {# TODO: CSRF #}

                {# --- Выбор Категорий --- #}
                <div class="mb-3">
                    <label class="form-label">
                        {% if lang == 'ru' %}Выберите категории:{% elif lang == 'nl' %}Kies categorieën:{% else %}Select Categories:{% endif %}
                    </label>
                    <div class="category-list">
                        <div class="form-check">
                             <input class="form-check-input" type="checkbox" name="category_ids" value="all" id="cat_all" checked>
                             <label class="form-check-label" for="cat_all">
                                 {% if lang == 'ru' %}Все категории{% elif lang == 'nl' %}Alle categorieën{% else %}All Categories{% endif %}
                             </label>
                         </div>
                         <hr>
                        {% for category in categories %} {# Предполагаем, что categories передается из view #}
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="category_ids" value="{{ category.id }}" id="cat_{{ category.id }}">
                            <label class="form-check-label" for="cat_{{ category.id }}">
                                {{ category.name }}
                            </label>
                        </div>
                        {% else %}
                         <p class="text-muted small">{% if lang == 'ru' %}Категории не найдены.{% elif lang == 'nl' %}Geen categorieën gevonden.{% else %}No categories found.{% endif %}</p>
                        {% endfor %}
                    </div>
                </div>

                {# --- Выбор Количества Вопросов --- #}
                <div class="mb-4">
                    <label class="form-label d-block">
                         {% if lang == 'ru' %}Количество вопросов:{% elif lang == 'nl' %}Aantal vragen:{% else %}Number of Questions:{% endif %}
                    </label>
                    <div class="btn-group" role="group" aria-label="Number of questions">
                        {% for num in [10, 15, 20, 30] %}
                        <input type="radio" class="btn-check" name="num_questions" id="num_{{ num }}" value="{{ num }}" autocomplete="off" {% if loop.first %}checked{% endif %}>
                        <label class="btn btn-outline-secondary" for="num_{{ num }}">{{ num }}</label>
                        {% endfor %}
                    </div>
                </div>

                {# --- Кнопка Запуска --- #}
                <div class="d-grid">
                     <button type="submit" class="btn btn-primary btn-lg">
                         <i class="bi bi-play-circle-fill me-2"></i>{% if lang == 'ru' %}Начать Тест{% elif lang == 'nl' %}Start Toets{% else %}Start Test{% endif %}
                     </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}