{% extends "base.html" %}

{# SEO Meta Tags #}
{% block title %}{{ t('big_info.seo.title', lang) }}{% endblock %}
{% block meta_description %}{{ t('big_info.seo.description', lang) }}{% endblock %}

{# Custom CSS for this page #}
{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/big-info.css') }}">
{% endblock %}

{# JavaScript for this page - moved to head #}
{% block page_scripts %}
<script>
// Глобальные переменные для отслеживания состояния
let activeStep = null;

// Функция для переключения шага
function toggleStep(headerElement) {
    const content = headerElement.nextElementSibling;
    const icon = headerElement.querySelector('.big-step-icon');
    
    // Закрыть все остальные шаги
    const allHeaders = document.querySelectorAll('.big-step-header');
    const allContents = document.querySelectorAll('.big-step-content');
    
    allHeaders.forEach(header => {
        if (header !== headerElement) {
            header.classList.remove('active');
            header.querySelector('.big-step-icon').textContent = '▼';
        }
    });
    
    allContents.forEach(otherContent => {
        if (otherContent !== content) {
            otherContent.classList.remove('active');
        }
    });
    
    // Переключить текущий шаг
    headerElement.classList.toggle('active');
    content.classList.toggle('active');
    
    if (content.classList.contains('active')) {
        icon.textContent = '▲';
        updateProgress();
        activeStep = headerElement;
    } else {
        icon.textContent = '▼';
        activeStep = null;
    }
}

function updateProgress() {
    const activeSteps = document.querySelectorAll('.big-step-header.active').length;
    const totalSteps = document.querySelectorAll('.big-step-header').length;
    const progress = (activeSteps / totalSteps) * 100;
    
    document.getElementById('overallProgress').style.width = progress + '%';
}

// Инициализация при загрузке DOM
document.addEventListener('DOMContentLoaded', function() {
    // Добавляем обработчики событий для всех заголовков
    document.querySelectorAll('.big-step-header').forEach(header => {
        header.addEventListener('click', function() {
            toggleStep(this);
            
            // Плавная прокрутка
            setTimeout(() => {
                this.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
            }, 300);
        });
    });

    // Автоматически открыть первый шаг
    const firstStep = document.querySelector('.big-step-header');
    if (firstStep) {
        setTimeout(() => {
            toggleStep(firstStep);
        }, 1000);
    }

    // Наблюдатель для анимаций при скролле
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Наблюдать за всеми карточками и подразделами
    const elementsToObserve = document.querySelectorAll('.big-info-card, .big-subsection, .big-alert');
    elementsToObserve.forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(el);
    });
});
</script>
{% endblock %}

{% block content %}
<section id="big-info-content" class="main-content-padding big-info-section">
    <div class="big-page-header">
        <h1 class="big-page-title">{{ t('big_info.page.title', lang) }}</h1>
        <p class="big-page-subtitle">{{ t('big_info.page.subtitle', lang) }}</p>
    </div>

    <!-- Прогресс общего процесса -->
    <div class="big-progress-container">
        <div class="big-progress-title">{{ t('big_info.progress.title', lang) }}</div>
        <div class="big-progress-bar">
            <div class="big-progress-fill" style="width: 0%" id="overallProgress"></div>
        </div>
    </div>

    <!-- Шаг 1: Оценка образования -->
    <div class="big-step-container">
        <div class="big-step-header">
            <div class="big-step-header-content">
                <div class="big-step-number">1</div>
                <h2 class="big-step-title">{{ t('big_info.step1.title', lang) }}</h2>
                <span class="big-step-icon">▼</span>
            </div>
        </div>
        <div class="big-step-content">
            <div class="big-step-content-inner">
                <p class="big-step-description">{{ t('big_info.step1.description', lang) }}</p>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step1.documents.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <ul class="big-custom-list">
                            <li>{{ t('big_info.step1.documents.diploma', lang) }}</li>
                            <li>{{ t('big_info.step1.documents.transcript', lang) }}</li>
                            <li>{{ t('big_info.step1.documents.internships', lang) }}</li>
                            <li>{{ t('big_info.step1.documents.translations', lang) }}</li>
                            <li>{{ t('big_info.step1.documents.conduct_certificate', lang) }}</li>
                        </ul>
                    </div>
                </div>

                <div class="big-alert big-alert-warning">
                    <strong>{{ t('big_info.step1.warning.title', lang) }}:</strong> {{ t('big_info.step1.warning.text', lang) }}
                </div>

                <div class="big-info-cards">
                    <div class="big-info-card">
                        <h4 class="big-info-card-title">{{ t('big_info.step1.timeline.title', lang) }}</h4>
                        <p>{{ t('big_info.step1.timeline.text', lang) }}</p>
                    </div>
                    <div class="big-info-card">
                        <h4 class="big-info-card-title">{{ t('big_info.step1.cost.title', lang) }}</h4>
                        <p>{{ t('big_info.step1.cost.text', lang) }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Шаг 2: Языковая подготовка -->
    <div class="big-step-container">
        <div class="big-step-header">
            <div class="big-step-header-content">
                <div class="big-step-number">2</div>
                <h2 class="big-step-title">{{ t('big_info.step2.title', lang) }}</h2>
                <span class="big-step-icon">▼</span>
            </div>
        </div>
        <div class="big-step-content">
            <div class="big-step-content-inner">
                <p class="big-step-description">{{ t('big_info.step2.description', lang) }}</p>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step2.requirements.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <table class="big-info-table">
                            <thead>
                                <tr>
                                    <th>{{ t('big_info.step2.table.skill', lang) }}</th>
                                    <th>{{ t('big_info.step2.table.level', lang) }}</th>
                                    <th>{{ t('big_info.step2.table.exam', lang) }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>{{ t('big_info.step2.table.general_dutch', lang) }}</td>
                                    <td>B2+</td>
                                    <td>{{ t('big_info.step2.table.staatsexamen', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step2.table.english_reading', lang) }}</td>
                                    <td>B2</td>
                                    <td>{{ t('big_info.step2.table.alternative', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step2.table.medical_terminology', lang) }}</td>
                                    <td>{{ t('big_info.step2.table.professional', lang) }}</td>
                                    <td>{{ t('big_info.step2.table.bi_toets_part', lang) }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="big-alert big-alert-info">
                    <strong>{{ t('big_info.step2.tip.title', lang) }}:</strong> {{ t('big_info.step2.tip.text', lang) }}
                </div>
            </div>
        </div>
    </div>

    <!-- Шаг 3: BI-Toets (самый подробный) -->
    <div class="big-step-container">
        <div class="big-step-header">
            <div class="big-step-header-content">
                <div class="big-step-number">3</div>
                <h2 class="big-step-title">{{ t('big_info.step3.title', lang) }}</h2>
                <span class="big-step-icon">▼</span>
            </div>
        </div>
        <div class="big-step-content">
            <div class="big-step-content-inner">
                <p class="big-step-description">{{ t('big_info.step3.description', lang) }}</p>

                <div class="big-alert big-alert-warning">
                    <strong>{{ t('big_info.step3.key_info.title', lang) }}:</strong> 
                    <br>• {{ t('big_info.step3.key_info.cost', lang) }}
                    <br>• {{ t('big_info.step3.key_info.frequency', lang) }}
                    <br>• {{ t('big_info.step3.key_info.participants', lang) }}
                    <br>• {{ t('big_info.step3.key_info.duration', lang) }}
                </div>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step3.theory.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <div class="big-info-cards">
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.theory.basic_medical.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.theory.basic_medical.anatomy', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.basic_medical.pathology', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.basic_medical.pharmacology', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.basic_medical.microbiology', lang) }}</li>
                                </ul>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.theory.thk1.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.theory.thk1.cariology', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.thk1.endodontics', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.thk1.pediatric', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.thk1.periodontology', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.thk1.saliva', lang) }}</li>
                                </ul>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.theory.thk2.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.theory.thk2.prosthetics', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.thk2.implantology', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.thk2.orthodontics', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.thk2.surgery', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.thk2.kinesiology', lang) }}</li>
                                </ul>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.theory.radiology.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.theory.radiology.interpretation', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.radiology.safety', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.radiology.methods', lang) }}</li>
                                </ul>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.theory.statistics.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.theory.statistics.descriptive', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.statistics.tests', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.statistics.interpretation', lang) }}</li>
                                </ul>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.theory.methodology.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.theory.methodology.pico', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.methodology.research_design', lang) }}</li>
                                    <li>{{ t('big_info.step3.theory.methodology.evidence_based', lang) }}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step3.practical.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <table class="big-info-table">
                            <thead>
                                <tr>
                                    <th>{{ t('big_info.step3.practical.table.skill', lang) }}</th>
                                    <th>{{ t('big_info.step3.practical.table.attempts', lang) }}</th>
                                    <th>{{ t('big_info.step3.practical.table.description', lang) }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>{{ t('big_info.step3.practical.manual_skills', lang) }}</td>
                                    <td>3</td>
                                    <td>{{ t('big_info.step3.practical.manual_description', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step3.practical.caries_excavation', lang) }}</td>
                                    <td>1</td>
                                    <td>{{ t('big_info.step3.practical.caries_description', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step3.practical.endo_preparation', lang) }}</td>
                                    <td>2</td>
                                    <td>{{ t('big_info.step3.practical.endo_description', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step3.practical.crown_preparation', lang) }}</td>
                                    <td>2</td>
                                    <td>{{ t('big_info.step3.practical.crown_description', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step3.practical.cleaning', lang) }}</td>
                                    <td>1</td>
                                    <td>{{ t('big_info.step3.practical.cleaning_description', lang) }}</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="big-alert big-alert-success">
                            <strong>{{ t('big_info.step3.practical.success.title', lang) }}:</strong> {{ t('big_info.step3.practical.success.text', lang) }}
                        </div>
                    </div>
                </div>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step3.intake_ethics.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <div class="big-info-cards">
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.intake.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.intake.zoom_conversation', lang) }}</li>
                                    <li>{{ t('big_info.step3.intake.history_taking', lang) }}</li>
                                    <li>{{ t('big_info.step3.intake.procedure_explanation', lang) }}</li>
                                    <li>{{ t('big_info.step3.intake.empathy', lang) }}</li>
                                </ul>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.ethics.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.ethics.gerodontology', lang) }}</li>
                                    <li>{{ t('big_info.step3.ethics.anxious_patients', lang) }}</li>
                                    <li>{{ t('big_info.step3.ethics.disabled_patients', lang) }}</li>
                                    <li>{{ t('big_info.step3.ethics.behavior_management', lang) }}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step3.treatment_planning.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <div class="big-info-cards">
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.case1.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.case1.phase1', lang) }}</li>
                                    <li>{{ t('big_info.step3.case1.phase2', lang) }}</li>
                                    <li>{{ t('big_info.step3.case1.phase3', lang) }}</li>
                                    <li>{{ t('big_info.step3.case1.phase4', lang) }}</li>
                                    <li>{{ t('big_info.step3.case1.phase5', lang) }}</li>
                                </ul>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.case2.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.case2.icdas', lang) }}</li>
                                    <li>{{ t('big_info.step3.case2.xrays', lang) }}</li>
                                    <li>{{ t('big_info.step3.case2.pediatric_plan', lang) }}</li>
                                    <li>{{ t('big_info.step3.case2.prevention', lang) }}</li>
                                </ul>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step3.case3.title', lang) }}</h4>
                                <ul class="big-custom-list">
                                    <li>{{ t('big_info.step3.case3.trauma_diagnosis', lang) }}</li>
                                    <li>{{ t('big_info.step3.case3.resorption_types', lang) }}</li>
                                    <li>{{ t('big_info.step3.case3.treatment_plan', lang) }}</li>
                                    <li>{{ t('big_info.step3.case3.prognosis', lang) }}</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step3.passing_criteria.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <table class="big-info-table">
                            <thead>
                                <tr>
                                    <th>{{ t('big_info.step3.passing.component', lang) }}</th>
                                    <th>{{ t('big_info.step3.passing.requirement', lang) }}</th>
                                    <th>{{ t('big_info.step3.passing.passing_grade', lang) }}</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>{{ t('big_info.step3.passing.theory', lang) }}</td>
                                    <td>{{ t('big_info.step3.passing.theory_req', lang) }}</td>
                                    <td>{{ t('big_info.step3.passing.theory_grade', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step3.passing.practical', lang) }}</td>
                                    <td>{{ t('big_info.step3.passing.practical_req', lang) }}</td>
                                    <td>{{ t('big_info.step3.passing.practical_grade', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step3.passing.treatment', lang) }}</td>
                                    <td>{{ t('big_info.step3.passing.treatment_req', lang) }}</td>
                                    <td>{{ t('big_info.step3.passing.treatment_grade', lang) }}</td>
                                </tr>
                                <tr>
                                    <td>{{ t('big_info.step3.passing.overall', lang) }}</td>
                                    <td>{{ t('big_info.step3.passing.overall_req', lang) }}</td>
                                    <td>{{ t('big_info.step3.passing.overall_grade', lang) }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="big-alert big-alert-danger">
                    <strong>{{ t('big_info.step3.failure.title', lang) }}:</strong>
                    <br>• {{ t('big_info.step3.failure.additional_courses', lang) }}
                    <br>• {{ t('big_info.step3.failure.repeat_after_2_years', lang) }}
                    <br>• {{ t('big_info.step3.failure.individual_assessment', lang) }}
                </div>
            </div>
        </div>
    </div>

    <!-- Шаг 4: Практическая оценка -->
    <div class="big-step-container">
        <div class="big-step-header">
            <div class="big-step-header-content">
                <div class="big-step-number">4</div>
                <h2 class="big-step-title">{{ t('big_info.step4.title', lang) }}</h2>
                <span class="big-step-icon">▼</span>
            </div>
        </div>
        <div class="big-step-content">
            <div class="big-step-content-inner">
                <p class="big-step-description">{{ t('big_info.step4.description', lang) }}</p>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step4.types.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <div class="big-info-cards">
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step4.aanpassingsstage.title', lang) }}</h4>
                                <p>{{ t('big_info.step4.aanpassingsstage.description', lang) }}</p>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step4.proeve.title', lang) }}</h4>
                                <p>{{ t('big_info.step4.proeve.description', lang) }}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="big-alert big-alert-info">
                    <strong>{{ t('big_info.step4.goal.title', lang) }}:</strong> {{ t('big_info.step4.goal.text', lang) }}
                </div>
            </div>
        </div>
    </div>

    <!-- Шаг 5: Финальная регистрация -->
    <div class="big-step-container">
        <div class="big-step-header">
            <div class="big-step-header-content">
                <div class="big-step-number">5</div>
                <h2 class="big-step-title">{{ t('big_info.step5.title', lang) }}</h2>
                <span class="big-step-icon">▼</span>
            </div>
        </div>
        <div class="big-step-content">
            <div class="big-step-content-inner">
                <p class="big-step-description">{{ t('big_info.step5.description', lang) }}</p>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step5.process.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <ul class="big-custom-list">
                            <li>{{ t('big_info.step5.process.account', lang) }} <a href="https://www.bigregister.nl" target="_blank">bigregister.nl</a></li>
                            <li>{{ t('big_info.step5.process.documents', lang) }}</li>
                            <li>{{ t('big_info.step5.process.payment', lang) }}</li>
                            <li>{{ t('big_info.step5.process.waiting', lang) }}</li>
                            <li>{{ t('big_info.step5.process.big_number', lang) }}</li>
                        </ul>
                    </div>
                </div>

                <div class="big-alert big-alert-success">
                    <strong>{{ t('big_info.step5.congratulations.title', lang) }}!</strong> {{ t('big_info.step5.congratulations.text', lang) }}
                </div>

                <div class="big-subsection">
                    <h3 class="big-subsection-title">{{ t('big_info.step5.after_big.title', lang) }}</h3>
                    <div class="big-subsection-content">
                        <div class="big-info-cards">
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step5.job_search.title', lang) }}</h4>
                                <p>{{ t('big_info.step5.job_search.text', lang) }}</p>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step5.education.title', lang) }}</h4>
                                <p>{{ t('big_info.step5.education.text', lang) }}</p>
                            </div>
                            <div class="big-info-card">
                                <h4 class="big-info-card-title">{{ t('big_info.step5.insurance.title', lang) }}</h4>
                                <p>{{ t('big_info.step5.insurance.text', lang) }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Финальная информация -->
    <div class="big-final-cta">
        <a href="{{ url_for('learning_map_bp.learning_map', lang=lang) }}" class="big-btn">
            📚 {{ t('big_info.cta.start_preparation', lang) }}
        </a>
    </div>
</section>
{% endblock %}