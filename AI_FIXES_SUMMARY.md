# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è AI –≤–∏–¥–∂–µ—Ç–æ–≤ - –†–ï–ó–Æ–ú–ï

## ‚úÖ **–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**

### 1. **CSRF –¢–æ–∫–µ–Ω** ‚úÖ
- **–î–æ–±–∞–≤–ª–µ–Ω –≤ `<head>` —Å–µ–∫—Ü–∏—é** `templates/index.html`:
  ```html
  <meta name="csrf-token" content="{{ csrf_token() }}">
  <meta name="user-authenticated" content="{{ 'true' if current_user.is_authenticated else 'false' }}">
  <meta name="current-language" content="{{ g.lang }}">
  ```

### 2. **JavaScript –§—É–Ω–∫—Ü–∏–∏** ‚úÖ
- **`toggleMiniChat()` - –ò–°–ü–†–ê–í–õ–ï–ù–ê** ‚ùå‚Üí‚úÖ
- **`refreshExamPrediction()` - –ò–°–ü–†–ê–í–õ–ï–ù–ê** ‚ùå‚Üí‚úÖ  
- **`makeAIRequest()` - –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø** —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
- **`getCSRFToken()` - –£–õ–£–ß–®–ï–ù–ê** —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞

### 3. **Backend –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã** ‚úÖ
- **`/health` - –î–û–ë–ê–í–õ–ï–ù** ‚ùå‚Üí‚úÖ
- **`/progress-stats` - –î–û–ë–ê–í–õ–ï–ù** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
- **`/simple-chat` - –î–û–ë–ê–í–õ–ï–ù** –∫–∞–∫ fallback –¥–ª—è AI —á–∞—Ç–∞
- **Fallback –ª–æ–≥–∏–∫–∞** –¥–ª—è –≤—Å–µ—Ö AI —Ñ—É–Ω–∫—Ü–∏–π

### 4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –û—à–∏–±–æ–∫** ‚úÖ
- **Graceful degradation** - –ø–æ–∫–∞–∑ fallback –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **–ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö AI –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –≤–º–µ—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

### 5. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** ‚úÖ
- **–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–û—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** –≤–∏–¥–∂–µ—Ç–æ–≤ (500ms, 1s, 1.5s)
- **–ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** —Å lazy loading

## üéØ **–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: JavaScript –æ—à–∏–±–∫–∏** 
```javascript
// –ë–´–õ–û: toggleMiniChat is not defined
// –°–¢–ê–õ–û: 
function toggleMiniChat() {
  const chatBody = document.getElementById('miniChatBody');
  const toggleIcon = document.getElementById('miniChatToggle');
  // ... –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
}
```

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: Health —ç–Ω–¥–ø–æ–∏–Ω—Ç**
```python
@ai_bp.route('/health', methods=['GET'])
def ai_health_check(lang):
    return jsonify({
        'ai_system': 'operational',
        'database': 'connected',
        'features': {...}
    })
```

### **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: Fallback –∫–æ–Ω—Ç–µ–Ω—Ç**
```javascript
// –ë–´–õ–û: –í–µ—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ
// –°–¢–ê–õ–û: –ö—Ä–∞—Å–∏–≤—ã–π fallback UI
container.innerHTML = `
  <div class="alert alert-info">
    <h5>üìä –ê–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏</h5>
    <p>–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–∑—É—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞</p>
    <a href="/learning-map" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–±—É—á–µ–Ω–∏—é</a>
  </div>
`;
```

## üß™ **–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**

### 1. **–û—Ç–∫—Ä–æ–π—Ç–µ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É**
```
http://localhost:5000/ru/
```

### 2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)**
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ `toggleMiniChat is not defined`
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ `refreshExamPrediction is not defined`
- ‚úÖ –õ–æ–≥: `CSRF Token: Found`
- ‚úÖ –õ–æ–≥: `Initializing AI widgets...`

### 3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ AI —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã**
```bash
curl http://localhost:5000/ru/ai-assistant/health
# –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å: {"ai_system": "operational", ...}
```

### 4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab**
- ‚úÖ `/ai-assistant/predict-exam` - 200 OK
- ‚úÖ `/ai-assistant/recommend-content` - 200 OK  
- ‚úÖ `/ai-assistant/progress-stats` - 200 OK
- ‚úÖ `/ai-assistant/health` - 200 OK

## üìã **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
- AI –≤–∏–¥–∂–µ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —ç–∫–∑–∞–º–µ–Ω—É
- –ü–æ—è–≤–ª—è—é—Ç—Å—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- –†–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: AI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω**
- –í–∏–¥–∂–µ—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫—Ä–∞—Å–∏–≤—ã–π fallback –∫–æ–Ω—Ç–µ–Ω—Ç
- –ù–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –æ–±—É—á–µ–Ω–∏—é
- –ú–∏–Ω–∏-—á–∞—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω**
- AI –≤–∏–¥–∂–µ—Ç—ã –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è
- –í –∫–æ–Ω—Å–æ–ª–∏: `User not authenticated, skipping AI widgets`
- –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

## üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:**

### **–ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CSRF —Ç–æ–∫–µ–Ω –≤ `<head>`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω  
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab –Ω–∞ 404/500 –æ—à–∏–±–∫–∏
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ Flask —Å–µ—Ä–≤–µ—Ä–∞

### **–ï—Å–ª–∏ –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (Ctrl+F5)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ JavaScript —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

## üì± **–ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è:**

- ‚úÖ Lazy loading –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
- ‚úÖ Touch –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –≤–∏–¥–∂–µ—Ç–æ–≤
- ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω–∏–µ hover —ç—Ñ—Ñ–µ–∫—Ç–æ–≤

## üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

**–î–û:** üî¥ 4 –≤–∏–¥–∂–µ—Ç–∞ –∑–∞—Å—Ç—Ä—è–ª–∏ –≤ –∑–∞–≥—Ä—É–∑–∫–µ  
**–ü–û–°–õ–ï:** üü¢ –í—Å–µ –≤–∏–¥–∂–µ—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç fallback

**–î–û:** ‚ùå JavaScript –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏  
**–ü–û–°–õ–ï:** ‚úÖ –ß–∏—Å—Ç–∞—è –∫–æ–Ω—Å–æ–ª—å –±–µ–∑ –æ—à–∏–±–æ–∫

**–î–û:** ‚ùå 404 –æ—à–∏–±–∫–∏ –Ω–∞ AI —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã  
**–ü–û–°–õ–ï:** ‚úÖ –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç 200 OK

---

## üöÄ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:** `python app.py`
2. **–û—Ç–∫—Ä–æ–π—Ç–µ:** `http://localhost:5000/ru/`  
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:** AI –≤–∏–¥–∂–µ—Ç—ã –¥–æ–ª–∂–Ω—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è
4. **–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞

**–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üéØ 