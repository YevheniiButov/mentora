# SESSION TERMINATION FIX REPORT

## –ü—Ä–æ–±–ª–µ–º–∞
–°–∏—Å—Ç–µ–º–∞ –∑–∞–≤–µ—Ä—à–∞–ª–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø–æ—Å–ª–µ 36 –≤–æ–ø—Ä–æ—Å–æ–≤ –≤–º–µ—Å—Ç–æ –æ–∂–∏–¥–∞–µ–º—ã—Ö 75 –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è preliminary —Ç–µ—Å—Ç–∞.

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
1. **–ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ –≤ –ª–æ–≥–∏–∫–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: `min_questions` (87) –±—ã–ª–æ –±–æ–ª—å—à–µ `max_questions` (75)
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –¥–æ–º–µ–Ω–æ–≤**: —Å–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–±–æ–≤–∞–ª–∞ 87 –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø–æ–∫—Ä—ã—Ç–∏—è –≤—Å–µ—Ö –¥–æ–º–µ–Ω–æ–≤, –Ω–æ –º–∞–∫—Å–∏–º—É–º –±—ã–ª 75
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**: –Ω–µ –±—ã–ª–æ –≤–∏–¥–Ω–æ, –≥–¥–µ –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ min_questions –≤ `utils/irt_engine.py`:

**–°—Ç—Ä–æ–∫–∏ 270-275:**
```python
# –ë–´–õ–û:
self._min_questions = len(self.all_domains) * self.questions_per_domain

# –°–¢–ê–õ–û:
calculated_min = len(self.all_domains) * self.questions_per_domain
self._min_questions = min(calculated_min, self.max_questions)
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –¥–æ–º–µ–Ω–æ–≤ –≤ `_check_termination_conditions`:

**–°—Ç—Ä–æ–∫–∏ 1050-1060:**
```python
# –ë–´–õ–û:
min_total_questions = total_domains_with_questions * min_questions_per_domain

# –°–¢–ê–õ–û:
calculated_min_total = total_domains_with_questions * min_questions_per_domain
min_total_questions = min(calculated_min_total, self.max_questions)
```

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ questions_per_domain –¥–ª—è readiness –≤ `routes/diagnostic_routes.py`:

**–°—Ç—Ä–æ–∫–∞ 175:**
```python
# –ë–´–õ–û:
'questions_per_domain': 1 if diagnostic_type == 'express' else (3 if diagnostic_type == 'preliminary' else 5),

# –°–¢–ê–õ–û:
'questions_per_domain': 1 if diagnostic_type == 'express' else (3 if diagnostic_type == 'preliminary' else 6),
```

### 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

- **–í `_check_termination_conditions`**: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —É—Å–ª–æ–≤–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- **–í `select_next_question`**: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
- **–í `routes/diagnostic_routes.py`**: –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏–∑ —Å–µ—Å—Å–∏–∏

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- **Min questions: 87** (–±–æ–ª—å—à–µ max_questions: 75)
- **Min total questions needed: 87** (–±–æ–ª—å—à–µ max_questions: 75)
- **–°–µ—Å—Å–∏—è –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–ª–∞—Å—å** –ø–æ —É—Å–ª–æ–≤–∏—é max_questions

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- **Min questions: 75** (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ max_questions)
- **Min total questions needed: 75** (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ max_questions)
- **–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø—Ä–∏ 75 –≤–æ–ø—Ä–æ—Å–∞—Ö** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ!

## –õ–æ–≥–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

1. **Domain coverage**: –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –¥–æ –ø–æ–∫—Ä—ã—Ç–∏—è –¥–æ–º–µ–Ω–æ–≤ (–Ω–æ –Ω–µ –±–æ–ª—å—à–µ max_questions)
2. **Min questions**: –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –¥–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ (–Ω–æ –Ω–µ –±–æ–ª—å—à–µ max_questions)
3. **Max questions**: –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –º–∞–∫—Å–∏–º—É–º–∞
4. **Precision threshold**: –∑–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ (SE ‚â§ 0.4)

## –°—Ç–∞—Ç—É—Å
üü¢ **–ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ü–†–û–¢–ï–°–¢–ò–†–û–í–ê–ù–û**

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã —Ç–µ–ø–µ—Ä—å –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:**
- **Express**: ~25 –≤–æ–ø—Ä–æ—Å–æ–≤
- **Preliminary**: ~75 –≤–æ–ø—Ä–æ—Å–æ–≤  
- **Readiness**: ~130 –≤–æ–ø—Ä–æ—Å–æ–≤

**–°–∏—Å—Ç–µ–º–∞ –±–æ–ª—å—à–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ç–µ—Å—Ç—ã –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ.**


