{% extends "digid/base_digid.html" %}
{% block title %}Registratie voltooien - Mentora{% endblock %}

{% block head %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=RijksoverheidSansWebText:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
:root {
    --digid-blue: #003d82;
    --digid-orange: #ff6600; 
    --digid-light-gray: #f5f5f5;
    --digid-border: #cccccc;
    --digid-text: #333333;
    --digid-text-light: #767676;
    --digid-background: #ffffff;
    --digid-success: #2e7d32;
    --digid-error: #d32f2f;
}

* {
    box-sizing: border-box;
}

body {
    font-family: 'RijksoverheidSansWebText', 'Inter', Arial, sans-serif;
    background: #f8f9fa;
    margin: 0;
    padding: 0;
    line-height: 1.5;
}

.digid-page-container {
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.digid-content-card {
    max-width: 600px;
    width: 100%;
    background: var(--digid-background);
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    overflow: hidden;
}

/* Header Section */
.digid-header {
    background: var(--digid-blue);
    color: white;
    padding: 24px 32px;
    text-align: center;
}

.digid-header h1 {
    margin: 0;
    font-size: 24px;
    font-weight: 600;
}

.digid-header p {
    margin: 8px 0 0 0;
    font-size: 16px;
    opacity: 0.9;
}

/* Main Content */
.digid-main-content {
    padding: 32px;
}

.digid-info-section {
    background: #e3f2fd;
    border: 1px solid #bbdefb;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 32px;
}

.digid-info-title {
    color: var(--digid-blue);
    font-size: 18px;
    font-weight: 600;
    margin: 0 0 16px 0;
}

.digid-readonly-field {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid #e0e0e0;
}

.digid-readonly-field:last-child {
    border-bottom: none;
}

.digid-readonly-label {
    font-weight: 500;
    color: var(--digid-text);
}

.digid-readonly-value {
    color: var(--digid-text-light);
    font-family: monospace;
}

/* Form Sections */
.digid-form-section {
    margin-bottom: 32px;
}

.digid-section-title {
    color: var(--digid-orange);
    font-size: 20px;
    font-weight: 600;
    margin: 0 0 20px 0;
}

/* Radio Buttons */
.digid-radio-group {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
}

.digid-radio-option {
    position: relative;
    background: var(--digid-light-gray);
    border: 2px solid var(--digid-border);
    border-radius: 8px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.digid-radio-option:hover {
    background: #f0f0f0;
    border-color: var(--digid-blue);
}

.digid-radio-option.selected {
    background: #e3f2fd;
    border-color: var(--digid-blue);
    box-shadow: 0 0 0 2px rgba(0, 61, 130, 0.1);
}

.digid-radio-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    cursor: pointer;
}

.digid-radio-content {
    display: flex;
    align-items: center;
    gap: 12px;
}

.digid-radio-icon {
    font-size: 24px;
}

.digid-radio-text {
    font-weight: 500;
    color: var(--digid-text);
}

/* File Upload */
.digid-upload-section {
    margin-bottom: 24px;
}

.digid-upload-label {
    display: block;
    font-weight: 500;
    color: var(--digid-text);
    margin-bottom: 8px;
}

.digid-upload-required {
    color: var(--digid-error);
    font-size: 12px;
    margin-left: 4px;
}

.digid-upload-optional {
    color: var(--digid-text-light);
    font-size: 12px;
    margin-left: 4px;
}

.digid-upload-area {
    border: 2px dashed var(--digid-border);
    border-radius: 8px;
    padding: 24px;
    text-align: center;
    background: var(--digid-light-gray);
    transition: all 0.2s ease;
}

.digid-upload-area:hover {
    border-color: var(--digid-blue);
    background: #f0f0f0;
}

.digid-upload-area.dragover {
    border-color: var(--digid-orange);
    background: #fff3e0;
}

.digid-upload-input {
    display: none;
}

.digid-upload-icon {
    font-size: 48px;
    color: var(--digid-text-light);
    margin-bottom: 16px;
}

.digid-upload-text {
    color: var(--digid-text);
    font-size: 16px;
    margin-bottom: 8px;
}

.digid-upload-hint {
    color: var(--digid-text-light);
    font-size: 14px;
}

.digid-btn-upload {
    background: var(--digid-blue);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 16px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    margin-top: 12px;
    transition: background-color 0.2s ease;
}

.digid-btn-upload:hover {
    background: #002a5c;
}

.digid-file-info {
    display: none;
    background: #e8f5e8;
    border: 1px solid #4caf50;
    border-radius: 4px;
    padding: 12px;
    margin-top: 12px;
}

.digid-file-info.show {
    display: block;
}

.digid-file-name {
    font-weight: 500;
    color: var(--digid-success);
}

.digid-file-size {
    color: var(--digid-text-light);
    font-size: 14px;
}

/* Submit Button */
.digid-submit-section {
    text-align: center;
    padding-top: 24px;
    border-top: 1px solid #e0e0e0;
}

.digid-btn-submit {
    background: var(--digid-orange);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 16px 32px;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.digid-btn-submit:hover {
    background: #e65100;
}

.digid-btn-submit:disabled {
    background: #cccccc;
    cursor: not-allowed;
}

/* Flash Messages */
.flash-messages {
    margin-bottom: 24px;
}

.flash-message {
    padding: 12px 16px;
    border-radius: 4px;
    margin-bottom: 12px;
}

.flash-message.success {
    background: #e8f5e8;
    border: 1px solid #4caf50;
    color: var(--digid-success);
}

.flash-message.danger {
    background: #ffebee;
    border: 1px solid #f44336;
    color: var(--digid-error);
}

@media (max-width: 768px) {
    .digid-radio-group {
        grid-template-columns: 1fr;
    }
    
    .digid-main-content {
        padding: 24px;
    }
    
    .digid-header {
        padding: 20px 24px;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="digid-page-container">
    <div class="digid-content-card">
        <div class="digid-header">
            <h1>Registratie voltooien</h1>
            <p>Vul onderstaande gegevens in om uw registratie te voltooien</p>
        </div>
        
        <div class="digid-main-content">
            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="flash-messages">
                        {% for category, message in messages %}
                            <div class="flash-message {{ category }}">{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}
            
            <!-- DigiD Information Section -->
            <div class="digid-info-section">
                <div class="digid-info-title">Uw DigiD gegevens</div>
                <div class="digid-readonly-field">
                    <span class="digid-readonly-label">Voornaam:</span>
                    <span class="digid-readonly-value">{{ user.first_name or 'Jan' }}</span>
                </div>
                <div class="digid-readonly-field">
                    <span class="digid-readonly-label">Achternaam:</span>
                    <span class="digid-readonly-value">{{ user.last_name or 'van der Berg' }}</span>
                </div>
                <div class="digid-readonly-field">
                    <span class="digid-readonly-label">BSN:</span>
                    <span class="digid-readonly-value">{{ user.bsn or '123456789' }}</span>
                </div>
            </div>
            
            <!-- Registration Form -->
            <form method="POST" enctype="multipart/form-data" id="registrationForm">
                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                <!-- Profession Selection -->
                <div class="digid-form-section">
                    <div class="digid-section-title">Selecteer uw professie <span class="digid-upload-required">*</span></div>
                    <div class="digid-radio-group">
                        <label class="digid-radio-option" for="profession_tandarts">
                            <input type="radio" id="profession_tandarts" name="profession" value="tandarts" required>
                            <div class="digid-radio-content">
                                <span class="digid-radio-icon">🦷</span>
                                <span class="digid-radio-text">Tandarts</span>
                            </div>
                        </label>
                        <label class="digid-radio-option" for="profession_apotheker">
                            <input type="radio" id="profession_apotheker" name="profession" value="apotheker" required>
                            <div class="digid-radio-content">
                                <span class="digid-radio-icon">💊</span>
                                <span class="digid-radio-text">Apotheker</span>
                            </div>
                        </label>
                        <label class="digid-radio-option" for="profession_huisarts">
                            <input type="radio" id="profession_huisarts" name="profession" value="huisarts" required>
                            <div class="digid-radio-content">
                                <span class="digid-radio-icon">🩺</span>
                                <span class="digid-radio-text">Huisarts</span>
                            </div>
                        </label>
                        <label class="digid-radio-option" for="profession_verpleegkundige">
                            <input type="radio" id="profession_verpleegkundige" name="profession" value="verpleegkundige" required>
                            <div class="digid-radio-content">
                                <span class="digid-radio-icon">👩‍⚕️</span>
                                <span class="digid-radio-text">Verpleegkundige</span>
                            </div>
                        </label>
                    </div>
                </div>
                
                <!-- Diploma Upload -->
                <div class="digid-form-section">
                    <div class="digid-section-title">Upload uw diploma <span class="digid-upload-required">*</span></div>
                    <div class="digid-upload-section">
                        <div class="digid-upload-area" id="diplomaUploadArea">
                            <input type="file" id="diploma_file" name="diploma_file" accept=".pdf" required class="digid-upload-input">
                            <div class="digid-upload-icon">📄</div>
                            <div class="digid-upload-text">Klik hier om uw diploma te uploaden</div>
                            <div class="digid-upload-hint">Alleen PDF bestanden, max 5MB</div>
                            <button type="button" class="digid-btn-upload" onclick="document.getElementById('diploma_file').click()">
                                Bestand selecteren
                            </button>
                        </div>
                        <div class="digid-file-info" id="diplomaFileInfo">
                            <div class="digid-file-name" id="diplomaFileName"></div>
                            <div class="digid-file-size" id="diplomaFileSize"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Language Certificate Upload -->
                <div class="digid-form-section">
                    <div class="digid-section-title">Upload uw taalcertificaat <span class="digid-upload-optional">(optioneel)</span></div>
                    <div class="digid-upload-section">
                        <div class="digid-upload-area" id="languageUploadArea">
                            <input type="file" id="language_certificate" name="language_certificate" accept=".pdf" class="digid-upload-input">
                            <div class="digid-upload-icon">📄</div>
                            <div class="digid-upload-text">Klik hier om uw taalcertificaat te uploaden</div>
                            <div class="digid-upload-hint">Alleen PDF bestanden, max 5MB</div>
                            <button type="button" class="digid-btn-upload" onclick="document.getElementById('language_certificate').click()">
                                Bestand selecteren
                            </button>
                        </div>
                        <div class="digid-file-info" id="languageFileInfo">
                            <div class="digid-file-name" id="languageFileName"></div>
                            <div class="digid-file-size" id="languageFileSize"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Submit Button -->
                <div class="digid-submit-section">
                    <button type="submit" class="digid-btn-submit">
                        Registratie voltooien
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Radio button selection
    const radioOptions = document.querySelectorAll('.digid-radio-option');
    radioOptions.forEach(option => {
        option.addEventListener('click', function() {
            // Remove selected class from all options
            radioOptions.forEach(opt => opt.classList.remove('selected'));
            // Add selected class to clicked option
            this.classList.add('selected');
        });
    });
    
    // File upload handlers
    function setupFileUpload(inputId, areaId, infoId, nameId, sizeId) {
        const input = document.getElementById(inputId);
        const area = document.getElementById(areaId);
        const info = document.getElementById(infoId);
        const nameEl = document.getElementById(nameId);
        const sizeEl = document.getElementById(sizeId);
        
        input.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                nameEl.textContent = file.name;
                sizeEl.textContent = `${(file.size / 1024 / 1024).toFixed(2)} MB`;
                info.classList.add('show');
                area.style.border = '2px solid #4caf50';
                area.style.background = '#e8f5e8';
            } else {
                info.classList.remove('show');
                area.style.border = '2px dashed #cccccc';
                area.style.background = '#f5f5f5';
            }
        });
        
        // Drag and drop
        area.addEventListener('dragover', function(e) {
            e.preventDefault();
            area.classList.add('dragover');
        });
        
        area.addEventListener('dragleave', function(e) {
            e.preventDefault();
            area.classList.remove('dragover');
        });
        
        area.addEventListener('drop', function(e) {
            e.preventDefault();
            area.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                input.files = files;
                input.dispatchEvent(new Event('change'));
            }
        });
    }
    
    setupFileUpload('diploma_file', 'diplomaUploadArea', 'diplomaFileInfo', 'diplomaFileName', 'diplomaFileSize');
    setupFileUpload('language_certificate', 'languageUploadArea', 'languageFileInfo', 'languageFileName', 'languageFileSize');
    
    // Form validation
    const form = document.getElementById('registrationForm');
    form.addEventListener('submit', function(e) {
        const profession = document.querySelector('input[name="profession"]:checked');
        const diploma = document.getElementById('diploma_file').files[0];
        
        if (!profession) {
            e.preventDefault();
            alert('Selecteer een professie');
            return;
        }
        
        if (!diploma) {
            e.preventDefault();
            alert('Upload uw diploma');
            return;
        }
        
        // Check file size
        if (diploma.size > 5 * 1024 * 1024) {
            e.preventDefault();
            alert('Diploma bestand is te groot (max 5MB)');
            return;
        }
        
        const languageCert = document.getElementById('language_certificate').files[0];
        if (languageCert && languageCert.size > 5 * 1024 * 1024) {
            e.preventDefault();
            alert('Taalcertificaat bestand is te groot (max 5MB)');
            return;
        }
    });
});
</script>
{% endblock %} 