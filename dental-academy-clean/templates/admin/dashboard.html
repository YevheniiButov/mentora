{% extends 'admin/master.html' %}

{% block body %}
<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h2>–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</h2>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã -->
    <div class="row">
        <!-- –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã -->
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üè• –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç—ã</h5>
                </div>
                <div class="card-body">
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è–º–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤</p>
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('admin.virtual_patients') }}" class="btn btn-primary">
                            <i class="fas fa-list"></i> –°–ø–∏—Å–æ–∫ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
                        </a>
                        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#uploadScenarioModal">
                            <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ü—É—Ç–∏ –æ–±—É—á–µ–Ω–∏—è -->
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üìö –ü—É—Ç–∏ –æ–±—É—á–µ–Ω–∏—è</h5>
                </div>
                <div class="card-body">
                    <p>–°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–µ–π –æ–±—É—á–µ–Ω–∏—è</p>
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('learning_map_bp.learning_map', lang='ru') }}" class="btn btn-primary">
                            <i class="fas fa-sitemap"></i> –ö–∞—Ä—Ç–∞ –æ–±—É—á–µ–Ω–∏—è
                        </a>
                        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createPathModal">
                            <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –ø—É—Ç—å
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –£—Ä–æ–∫–∏ –∏ —Ç–µ—Å—Ç—ã -->
        <div class="col-md-4 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üìù –£—Ä–æ–∫–∏ –∏ —Ç–µ—Å—Ç—ã</h5>
                </div>
                <div class="card-body">
                    <p>–°–æ–∑–¥–∞–Ω–∏–µ —É—á–µ–±–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</p>
                    <div class="d-grid gap-2">
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createLessonModal">
                            <i class="fas fa-file-text"></i> –°–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫
                        </button>
                        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#createTestModal">
                            <i class="fas fa-question-circle"></i> –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ -->
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h5>
                </div>
                <div class="card-body">
                    <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å–∏—Å—Ç–µ–º—ã</p>
                    <div class="d-grid gap-2">
                        <a href="{{ url_for('admin.users') }}" class="btn btn-primary">
                            <i class="fas fa-users"></i> –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                        </a>
                        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addUserModal">
                            <i class="fas fa-user-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="col-md-6 mb-4">
            <div class="card">
                <div class="card-header">
                    <h5>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h5>
                </div>
                <div class="card-body">
                    {% if stats is defined %}
                    <div class="row text-center">
                        <div class="col-6">
                            <h4 class="text-primary">{{ stats.users if stats.users is defined else 0 }}</h4>
                            <small>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</small>
                        </div>
                        <div class="col-6">
                            <h4 class="text-success">{{ stats.scenarios if stats.scenarios is defined else 0 }}</h4>
                            <small>–°—Ü–µ–Ω–∞—Ä–∏–µ–≤</small>
                        </div>
                    </div>
                    {% else %}
                    <p class="text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
<!-- –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è -->
<div class="modal fade" id="uploadScenarioModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form method="post" enctype="multipart/form-data" action="{{ url_for('admin.index') }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="action" value="upload_scenario">
                    <div class="mb-3">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è</label>
                        <input type="text" class="form-control" name="title" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">–§–∞–π–ª —Å—Ü–µ–Ω–∞—Ä–∏—è (JSON)</label>
                        <input type="file" class="form-control" name="scenario_file" accept=".json" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" name="description" rows="3"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="btn btn-primary">–ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- –°–æ–∑–¥–∞–Ω–∏–µ –ø—É—Ç–∏ –æ–±—É—á–µ–Ω–∏—è -->
<div class="modal fade" id="createPathModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–°–æ–∑–¥–∞—Ç—å –ø—É—Ç—å –æ–±—É—á–µ–Ω–∏—è</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="{{ url_for('admin.index') }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="action" value="create_path">
                    <div class="mb-3">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—É—Ç–∏</label>
                        <input type="text" class="form-control" name="path_name" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" name="path_description" rows="3"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- –°–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–∫–∞ -->
<div class="modal fade" id="createLessonModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–°–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="{{ url_for('admin.index') }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="action" value="create_lesson">
                    <div class="mb-3">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞</label>
                        <input type="text" class="form-control" name="lesson_title" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</label>
                        <textarea class="form-control" name="lesson_content" rows="5"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ -->
<div class="modal fade" id="createTestModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="{{ url_for('admin.index') }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="action" value="create_test">
                    <div class="mb-3">
                        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞</label>
                        <input type="text" class="form-control" name="test_title" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea class="form-control" name="test_description" rows="3"></textarea>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
<div class="modal fade" id="addUserModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form method="post" action="{{ url_for('admin.index') }}">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="action" value="add_user">
                    <div class="mb-3">
                        <label class="form-label">–ò–º—è</label>
                        <input type="text" class="form-control" name="name" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-control" name="email" required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" class="form-control" name="password" required>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                        <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}