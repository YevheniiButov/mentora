# Административный Дашборд

## Обзор

Современный административный дашборд для мониторинга системы адаптивного обучения Mentora. Предоставляет реальные метрики, алерты и аналитику в удобном интерфейсе.

## Доступ

- **URL**: `/admin/dashboard` или `/admin/`
- **Требования**: Административные права (`role = 'admin'`)
- **Аутентификация**: Обязательна

## Основные разделы

### 1. Карточки метрик
- **Пользователи**: Общее количество, новые за неделю, активные
- **Диагностики**: Завершенные сессии, completion rate, средняя способность
- **Планы обучения**: Активные планы, переоценки, средний прогресс
- **Контент**: Вопросы, уроки, IRT покрытие

### 2. График активности
Интерактивный график Chart.js с данными за последние 7 дней:
- Регистрации пользователей
- Завершенные диагностики
- Пройденные уроки

### 3. Топ слабых доменов
Список доменов, которые чаще всего встречаются как слабые у пользователей с активными планами обучения.

### 4. Детальная статистика
- **Контент**: Покрытие IRT параметрами, статистика уроков
- **Обучение**: Прогресс, время на урок, способности, новые планы

### 5. Системные алерты
Автоматические уведомления о:
- Пользователях, требующих переоценку
- Низком проценте завершения диагностики
- Неполном IRT покрытии вопросов

## Технические детали

### Модели данных
```python
# Основные метрики
users_metrics = {
    'total_users': User.query.count(),
    'new_week': User.query.filter(User.created_at >= week_ago).count(),
    'active_week': User.query.join(UserProgress).filter(...).distinct().count(),
    'with_diagnostic': User.query.join(DiagnosticSession).filter(...).distinct().count(),
    'with_active_plan': User.query.join(PersonalLearningPlan).filter(...).distinct().count()
}

# Диагностические метрики
diagnostic_metrics = {
    'total_sessions': DiagnosticSession.query.count(),
    'completed_sessions': DiagnosticSession.query.filter_by(status='completed').count(),
    'completion_rate': (completed / total * 100),
    'avg_ability': db.session.query(func.avg(DiagnosticSession.current_ability)).scalar()
}
```

### Запросы оптимизации
- Использование `distinct()` для уникальных пользователей
- JOIN операции для связанных данных
- Агрегатные функции SQLAlchemy для вычислений

### Производительность
- Кэширование метрик (можно добавить Redis)
- Оптимизированные SQL запросы
- Ленивая загрузка связанных данных

## Расширение функциональности

### Добавление новых метрик
1. Добавить вычисление в функцию `dashboard()`
2. Передать в шаблон
3. Отобразить в соответствующей секции

### Новые алерты
```python
if some_condition:
    alerts.append({
        'type': 'warning',  # warning, info, danger, success
        'message': 'Описание проблемы',
        'link': url_for('admin.some_route')  # опционально
    })
```

### Дополнительные графики
1. Добавить данные в `daily_activity`
2. Создать новый canvas в шаблоне
3. Настроить Chart.js конфигурацию

## Безопасность

- Проверка административных прав через декоратор `@admin_required`
- Валидация входных данных
- Защита от SQL инъекций через ORM
- Логирование административных действий

## Мониторинг

### Ключевые показатели
- **Completion rate диагностики**: Цель > 70%
- **IRT покрытие**: Цель 100%
- **Активные пользователи**: Мониторинг трендов
- **Переоценки**: Своевременное выявление

### Алерты
- Автоматические уведомления о критических проблемах
- Ссылки на соответствующие разделы админки
- Возможность настройки пороговых значений

## Развертывание

Дашборд готов к продакшену и включает:
- ✅ Адаптивный дизайн (Bootstrap 5)
- ✅ Интерактивные графики (Chart.js)
- ✅ Оптимизированные запросы
- ✅ Система алертов
- ✅ Безопасность и авторизация

## Следующие шаги

1. **Интеграция с мониторингом**: Подключение к системам логирования
2. **Экспорт данных**: Возможность выгрузки отчетов
3. **Настройка алертов**: Email/SMS уведомления
4. **Детальная аналитика**: Drill-down по метрикам
5. **A/B тестирование**: Сравнение эффективности функций 